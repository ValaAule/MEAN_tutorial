angular.module("app",["ngRoute"]),console.log("module.js: access to module successful"),angular.module("app").controller("ApplicationCtrl",["$scope",function(o){o.$on("login",function(s,e){o.currentUser=e,console.log("application.ctrl.js = login successful")})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(o,s){o.login=function(e,t){s.login(e,t).then(function(s){o.$emit("login",s),console.log("login.ctrl.js: login successful")})}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(o,s){o.addPost=function(){o.postBody&&s.create({username:"Add Post Button",body:o.postBody}).success(function(s){o.posts.unshift(s),o.postBody=null,console.log("posts.ctrl.js: create post successful")})},o.$on("ws:new_post",function(s,e){o.$apply(function(){o.posts.unshift(e),console.log("posts.ctrl.js: websocket new post successful")})}),s.fetch().success(function(s){o.posts=s,console.log("posts.ctrl.js: fetch post successful")})}]),angular.module("app").service("PostsSvc",["$http",function(o){this.fetch=function(){return console.log("posts.svc.js: fetch post successful"),o.get("/api/posts")},this.create=function(s){return console.log("posts.svc.js: create post successful"),o.post("/api/posts",s)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(o,s){o.register=function(e,t){s.register(e,t).then(function(s){o.$emit("login",s),console.log("register.ctrl.js: registration succesful")})}}]),angular.module("app").config(["$routeProvider",function(o){o.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}),console.log("routes.js: routing succesful")}]),angular.module("app").service("UserSvc",["$http",function(o){var s=this;s.getUser=function(){return o.get("/api/users").then(function(o){return console.log("user.svc.js: get user successful"),o.data})},s.login=function(e,t){return o.post("/api/sessions",{username:e,password:t}).then(function(e){return s.token=e.data,o.defaults.headers.common["X-Auth"]=e.data,console.log("user.svc.js: login successful"),s.getUser()})},s.register=function(e,t){return console.log("user.svc.js: user registration successful"),o.post("/api/users",{username:e,password:t}).then(function(){return s.login(e,t)})}}]),angular.module("app").run(["$rootScope","$timeout",function(o,s){!function e(){var t="ws://localhost:3000",n=new WebSocket(t);n.onopen=function(){console.log("ng/websockets.js: websocket connected")},n.onclose=function(){console.log("Websocket closed. Reconnecting..."),s(e,1e4)},n.onmessage=function(s){console.log(s);var e=JSON.parse(s.data);o.$broadcast("ws:"+e.topic,e.data)}}()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnNvbGUiLCJsb2ciLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsIlVzZXJTdmMiLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJ0aGVuIiwiJGVtaXQiLCJQb3N0c1N2YyIsImFkZFBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsImJvZHkiLCJzdWNjZXNzIiwicG9zdCIsInBvc3RzIiwidW5zaGlmdCIsIiRhcHBseSIsImZldGNoIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsInJlZ2lzdGVyIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzdmMiLCJnZXRVc2VyIiwicmVzcG9uc2UiLCJkYXRhIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJydW4iLCIkcm9vdFNjb3BlIiwiJHRpbWVvdXQiLCJjb25uZWN0IiwidXJsIiwiY29ubmVjdGlvbiIsIldlYlNvY2tldCIsIm9ub3BlbiIsIm9uY2xvc2UiLCJvbm1lc3NhZ2UiLCJlIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0b3BpYyJdLCJtYXBwaW5ncyI6IkFBR0FBLFFBQVFDLE9BQU8sT0FDWCxZQUdKQyxRQUFRQyxJQUFJLDBDQ0haSCxRQUFRQyxPQUFPLE9BQ2RHLFdBQVcsbUJBQUEsU0FBbUIsU0FBU0MsR0FDaENBLEVBQU9DLElBQUksUUFBUyxTQUFTQyxFQUFHQyxHQUM1QkgsRUFBT0ksWUFBY0QsRUFDckJOLFFBQVFDLElB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LEVBQVdJLFVBQVksU0FBU0MsR0FDNUJwRCxRQUFRQyxJQUFJbUQsRUFDWixJQUFJQyxHQUFVQyxLQUFLQyxNQUFNSCxFQUFFZixLQUMzQk0sR0FBV2EsV0FBVyxNQUFRSCxFQUFRSSxNQUFPSixFQUFRaEIiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IEF1bGUgb24gMi83LzE1LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJyxbXG4gICAgJ25nUm91dGUnXG5dKVxuXG5jb25zb2xlLmxvZygnbW9kdWxlLmpzOiBhY2Nlc3MgdG8gbW9kdWxlIHN1Y2Nlc3NmdWwnKSIsIi8qKlxuICogQ3JlYXRlZCBieSBBdWxlIG9uIDIvMTIvMTUuXG4gKiBVc2VkIGZvciBsb2dpbiBwYWdlXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sIHVzZXIpIHtcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHVzZXJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhcHBsaWNhdGlvbi5jdHJsLmpzID0gbG9naW4gc3VjY2Vzc2Z1bCcgKVxuICAgICAgICB9KVxuICAgIH0pIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IEF1bGUgb24gMi85LzE1LlxuICogVXNlZCBmb3IgbG9naW4gcGFnZVxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMpIHtcbiAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICAgICAgVXNlclN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh1c2VyKXtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsb2dpbi5jdHJsLmpzOiBsb2dpbiBzdWNjZXNzZnVsJylcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9KSIsIi8qKlxuICogQ3JlYXRlZCBieSBBdWxlIG9uIDIvNi8xNS5cbiAqIGNyZWF0ZSB0aGUgUG9zdHNDdHJsIG1vZHVsZSBhbmQgZGVwZW5kZW5jeSBpbmplY3QgJHNjb3BlLCB0aGUgc2NvcGUgdGllcy9nbHVlcyB0aGUgY29udHJvbGxlciB0byB0aGUgdmlld1xuICogaW50ZWdyYXRlIHRvIHRoZSBSRVNUIEFQSSB0byBwb3N0IGJhY2sgdG8gTW9uZ29EQi4gIE9ubHkgdGhlIHN1Y2Nlc3MgZnVuY3Rpb24gaXMgcG9zdGVkIGFuZCBpdCBudWxscyB0aGUgdmFsdWUgZm9yIHRoZSBuZXh0IHRpbWVcbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKFwiUG9zdHNDdHJsXCIsZnVuY3Rpb24gKCRzY29wZSwgUG9zdHNTdmMpIHtcbiAgICAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XG4gICAgICAgICAgICBQb3N0c1N2Yy5jcmVhdGUoe1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAnQWRkIFBvc3QgQnV0dG9uJyxcbiAgICAgICAgICAgICAgICBib2R5OiAkc2NvcGUucG9zdEJvZHlcbiAgICAgICAgICAgIC8vaWYgc2VydmVyIHJlc3BvbnNlcyBzdWNjZXNzLCB1bnNoaWZ0IChhZGQpIHRoZSBwb3N0IG9udG8gJHNjb3BlLnBvc3RzIGFuZCB0aGVuIHNldCBpdCB0byBudWxsXG4gICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdClcbiAgICAgICAgICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Bvc3RzLmN0cmwuanM6IGNyZWF0ZSBwb3N0IHN1Y2Nlc3NmdWwnKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuLy8gSSBkb24ndCBzZWVtIHRvIGJlIGFibGUgdG8gY2FsbCB0aGlzIGNvZGUgc3VjY2Vzc2Z1bGx5XG4kc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uIChfLCBwb3N0KSB7XG4gICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpXG4gICAgICAgIGNvbnNvbGUubG9nKCdwb3N0cy5jdHJsLmpzOiB3ZWJzb2NrZXQgbmV3IHBvc3Qgc3VjY2Vzc2Z1bCcpXG4gICAgICAgIH0pXG4gICAgfSlcblxuICAgIFBvc3RzU3ZjLmZldGNoKClcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKSB7XG4gICAgICAgICAgICAkc2NvcGUucG9zdHMgPSBwb3N0c1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Bvc3RzLmN0cmwuanM6IGZldGNoIHBvc3Qgc3VjY2Vzc2Z1bCcpXG4gICAgICAgIH0pXG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnUG9zdHNTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcbiAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZygncG9zdHMuc3ZjLmpzOiBmZXRjaCBwb3N0IHN1Y2Nlc3NmdWwnKVxuICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJylcbiAgICB9XG4gICAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbiAocG9zdCkge1xuICAgICAgICBjb25zb2xlLmxvZygncG9zdHMuc3ZjLmpzOiBjcmVhdGUgcG9zdCBzdWNjZXNzZnVsJylcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMnLCBwb3N0KVxuICAgIH1cbn0pIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IEF1bGUgb24gMi85LzE1LlxuICogVXNlZCBmb3IgcmVnaXN0ZXIgcGFnZVxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMpIHtcbiAgICAgICAgJHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICAgICAgVXNlclN2Yy5yZWdpc3Rlcih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh1c2VyKXtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZWdpc3Rlci5jdHJsLmpzOiByZWdpc3RyYXRpb24gc3VjY2VzZnVsJylcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9KSIsIi8qKlxuICogQ3JlYXRlZCBieSBBdWxlIG9uIDIvOS8xNS5cbiAqIFJvdXRpbmcgZmlsZSB0aGF0IG1hcHMgdGhlIGNvbnRyb2xsZXJzIGFuZCBodG1sIGZpbGVzXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uZmlnKGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAgICAgLndoZW4oJy8nLCB7Y29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCd9KVxuICAgICAgICAgICAgLndoZW4oJy9yZWdpc3RlcicsIHtjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJ30pXG4gICAgICAgICAgICAud2hlbignL2xvZ2luJywge2NvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLCB0ZW1wbGF0ZVVybDogJ2xvZ2luLmh0bWwnfSlcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyb3V0ZXMuanM6IHJvdXRpbmcgc3VjY2VzZnVsJylcbiAgICB9KSIsIi8qKlxuICogQ3JlYXRlZCBieSBBdWxlIG9uIDIvOS8xNS5cbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdVc2VyU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuICAgIHZhciBzdmMgPSB0aGlzXG4gICAgc3ZjLmdldFVzZXIgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygndXNlci5zdmMuanM6IGdldCB1c2VyIHN1Y2Nlc3NmdWwnKVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBzdmMubG9naW49ZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHN2Yy50b2tlbiA9IHJlc3BvbnNlLmRhdGFcbiAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGFcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2VyLnN2Yy5qczogbG9naW4gc3VjY2Vzc2Z1bCcpXG4gICAgICAgICAgICByZXR1cm4gc3ZjLmdldFVzZXIoKVxuICAgICAgICB9KVxuICAgIH1cblxuIC8vdXNlZCB0byByZWdpc3RlciBuZXcgdXNlcnMgYW5kIGF1dG9tYXRpY2FsbHkgbG9ncyB0aGVtIGluXG4gICAgc3ZjLnJlZ2lzdGVyID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICBjb25zb2xlLmxvZygndXNlci5zdmMuanM6IHVzZXIgcmVnaXN0cmF0aW9uIHN1Y2Nlc3NmdWwnKVxuICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgICAgIH0pXG4gICAgfVxufSkiLCIvKipcbiAqIENyZWF0ZWQgYnkgQXVsZSBvbiAyLzE5LzE1LlxuICogQW5ndWxhciBydW4gY29tcG9uZW50IGV4ZWN1dGVkIGR1cmluZyB0aGUgaW5pdGlhbGl6YXRpb24gcGhhc2VcbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAucnVuKGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkdGltZW91dCkge1xuICAgICAgICAoZnVuY3Rpb24gY29ubmVjdCgpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSAnd3M6Ly9sb2NhbGhvc3Q6MzAwMCdcbiAgICAgICAgICAgIHZhciBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh1cmwpXG5cbiAgICAgICAgICAgIGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25nL3dlYnNvY2tldHMuanM6IHdlYnNvY2tldCBjb25uZWN0ZWQnKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3JlY29ubmVjdCBsb2dpY1xuICAgICAgICAgICAgY29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnV2Vic29ja2V0IGNsb3NlZC4gUmVjb25uZWN0aW5nLi4uJylcbiAgICAgICAgICAgICAgICAkdGltZW91dChjb25uZWN0LCAxMCoxMDAwKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgICAgICAgICAgICB2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKVxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkgKClcbiAgICB9KSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==